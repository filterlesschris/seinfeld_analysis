---
title: "Seinfeld Analysis"
output: html_notebook
author: "Chris Gargano"
---

```{r}
# Install packages
library(tidyverse)
library(dplyr)
library(ggplot2)
```

```{r}
# Read in data file
data <- read.csv("../rawData/seinfeld.csv")
glimpse(data)

# Re-order dataframe and drop non-numerical variables
data <- data[,c("IMDB.Rating", "Season", "EpisodeNo", 
                "SentimentTotal", "LineCountTotal", "WordCountTotal",
                "SentimentJerry", "LineCountJerry", "WordCountJerry",
                "SentimentGeorge", "LineCountGeorge", "WordCountGeorge",
                "SentimentKramer", "LineCountKramer", "WordCountKramer",
                "SentimentElaine", "LineCountElaine", "WordCountElaine",
                "SentimentMainChars", "LineCountMainChars", "WordCountMainChars",
                "SentimentSecondary", "LineCountSecondary", "WordCountSecondary",
                "SentimentOther", "LineCountOther", "WordCountOther"
                )]
colnames(data)[colnames(data)=="IMDB.Rating"] <- "IMDBrating"
summary(data)
```

```{r}
# Create a regression model to predict "IMDB.Rating"
fit1 <- lm(IMDBrating ~ ., data)
summary(fit1)

# Residual Plot
plot(fit1$residuals, type = "h", col = "red", lwd = 2)

# Plot Actual vs. Predicted Values
plot(x = data$IMDBrating, y = fit1$fitted.values)

plot(fit1$fitted.values, type = "l", col = "blue", lwd = 2)
lines()

```


```{r}
# Read in data file (this data removed Sentiments of 0)
data2 <- read.csv("../rawData/seinfeld_v2.csv")
glimpse(data2)

# Re-order dataframe and drop non-numerical variables
data2 <- data2[,c("IMDBrating", 
                "PosTotal", "NegTotal", "CompTotal", "LineCountTotal", "WordCountTotal",
                "PosJerry", "NegJerry", "CompJerry", "LineCountJerry", "WordCountJerry",
                "PosGeorge", "NegGeorge", "CompGeorge", "LineCountGeorge", "WordCountGeorge",
                "PosKramer", "NegKramer", "CompKramer", "LineCountKramer", "WordCountKramer",
                "PosSecond", "NegSecond", "CompSecond", "LineCountSecond", "WordCountSecond",
                "PosOther", "NegOther", "CompOther", "LineCountOther", "WordCountOther",
                "TwoParter", "Pilot", "Finale"
                )]
#colnames(data)[colnames(data)=="IMDB.Rating"] <- "IMDBrating"
#summary(data)
```

```{r}
# Drop episode 1...
data2 <- data[c(2:dim(data)[1]),]
head(data2)

# Create a regression model to predict "IMDB.Rating"
fit2 <- lm(IMDBrating ~ ., data2)
summary(fit2)
```

```{r}
# Absolute value of all measures
data3 <- abs(data2)

fit3 <- lm(IMDBrating ~ ., data3)
summary(fit3)
```